<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>YAF - Documentation</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />

        <link rel="stylesheet" type="text/css" href="../../site/style.css" />
        <link rel="stylesheet" type="text/css" href="doxygen.css">
        <link rel="stylesheet" type="text/css" href="tabs.css">
</head>
<body>
    <div id="p-body">
      <div id="l-header">
        <img src="../../site/sei-logo.png" id="l-sei-logo"
            alt="Software Engineering Institute | Carnegie Mellon&copy;" />
        <div id="l-netsa-logo"><a id="l-netsa-name" href="../../index.html"><b>CERT NetSA Security Suite</b></a></div>
        <div id="l-netsa-motto">Monitoring for Large-Scale Networks</div>
        <h1 class="l-page-title">YAF</h1>
        <span id="l-subtitle">Documentation</span>
      </div><!-- l-header -->
      <div id="l-content">
        <div id="l-sidebar">
          <div class="p-sidebar-section">
            <h1><a href="index.html">YAF</a></h1>
            <ul>
              <li><a href="../docs.html">Documentation</a></li>
              <li><a href="../download.html">Downloads</a></li>
            </ul>
          </div><!-- p-sidebar-section -->
        </div><!-- l-sidebar -->
<!-- Generated by Doxygen 1.6.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>yafhooks.h File Reference</h1>
<p>Processing hook interface for YAF.  
<a href="#_details">More...</a></p>
<code>#include &lt;yaf/autoinc.h&gt;</code><br/>
<code>#include &lt;yaf/decode.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="yafcore_8h_source.html">yaf/yafcore.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="yaftab_8h_source.html">yaf/yaftab.h</a>&gt;</code><br/>
<code>#include &lt;pcre.h&gt;</code><br/>

<p><a href="yafhooks_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structyf_hook_meta_data.html">yfHookMetaData</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Exported from the plugin to tell YAF about its export data &amp; interface version.  <a href="structyf_hook_meta_data.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6f5462653bd733272e147c5cdab88392"></a><!-- doxytag: member="yafhooks.h::YAF_HOOK_INTERFACE_VERSION" ref="a6f5462653bd733272e147c5cdab88392" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#a6f5462653bd733272e147c5cdab88392">YAF_HOOK_INTERFACE_VERSION</a>&nbsp;&nbsp;&nbsp;5</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">HOOKS Plugin Version. <br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gboolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#acd19221bcb828e3b205ac1d1bae67dd5">yfHookPacket</a> (<a class="el" href="structyf_flow_key__st.html">yfFlowKey_t</a> *key, const uint8_t *pkt, size_t caplen, uint16_t iplen, <a class="el" href="structyf_t_c_p_info__st.html">yfTCPInfo_t</a> *tcpinfo, <a class="el" href="structyf_l2_info__st.html">yfL2Info_t</a> *l2info)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function called to do processing on each packet as it comes in.  <a href="#acd19221bcb828e3b205ac1d1bae67dd5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#a4e57f87d6a93b48cc0936ae97cd947c3">yfHookFlowPacket</a> (<a class="el" href="structyf_flow__st.html">yfFlow_t</a> *flow, <a class="el" href="structyf_flow_val__st.html">yfFlowVal_t</a> *val, const uint8_t *pkt, size_t caplen, uint16_t iplen, <a class="el" href="structyf_t_c_p_info__st.html">yfTCPInfo_t</a> *tcpinfo, <a class="el" href="structyf_l2_info__st.html">yfL2Info_t</a> *l2info)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Similar to yfHookPacket but also given yfFlowVal_t struct for processing per flow direction.  <a href="#a4e57f87d6a93b48cc0936ae97cd947c3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#a1e73b3cace941e2dc726996453778c60">yfHookValidateFlowTab</a> (uint32_t max_payload, gboolean uniflow, gboolean silkmode, gboolean applabelmode, gboolean entropymode, gboolean fingerprintmode, gboolean fpExportMode, gboolean udp_max_payload, uint16_t udp_uniflow_port)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Validation function to make sure the plugin can and should operate based on the flowtable options.  <a href="#a1e73b3cace941e2dc726996453778c60"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gboolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#a9b801e783cc418a5d6b4625984a9557e">yfHookFlowClose</a> (<a class="el" href="structyf_flow__st.html">yfFlow_t</a> *flow)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Called upon flow close to do any necessary plugin processing upon flow close.  <a href="#a9b801e783cc418a5d6b4625984a9557e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#a26154d71d6f5e035bd8f7f31c7af81c2">yfHookFlowAlloc</a> (<a class="el" href="structyf_flow__st.html">yfFlow_t</a> *flow)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Allow plugins to allocate flow state information for each flow captured by yaf at the time of flow creation.  <a href="#a26154d71d6f5e035bd8f7f31c7af81c2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#a0a95321f578ab86b78f7e7c348e2b004">yfHookFlowFree</a> (<a class="el" href="structyf_flow__st.html">yfFlow_t</a> *flow)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Frees all memory associated with the flow state in all of the attached plugins.  <a href="#a0a95321f578ab86b78f7e7c348e2b004"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">fbInfoElement_t *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#a101e734c147bf121eacdc6e0b7e5487c">yfHookGetInfoModel</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the IPFIX info model aggregated for all plugins.  <a href="#a101e734c147bf121eacdc6e0b7e5487c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gboolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#a3f9d70dbb8a7a2ab72e82977be7b4596">yfHookGetTemplate</a> (fbSession_t *session)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets the IPFIX info model template for the export data from _all_ the plugins and turns it into a single template to return.  <a href="#a3f9d70dbb8a7a2ab72e82977be7b4596"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gboolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#ad791565736a87937fd8c4004bf9d7a51">yfWriteFlowHook</a> (fbSubTemplateMultiList_t *rec, fbSubTemplateMultiListEntry_t *stml, <a class="el" href="structyf_flow__st.html">yfFlow_t</a> *flow, GError **err)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">called by yfWriteFlow to add the data from all registered plugins to the outgoing IPFIX record  <a href="#ad791565736a87937fd8c4004bf9d7a51"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gboolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#a702d0c8b8fc08d6c394d886b6e72717a">yfHookAddNewHook</a> (const char *hookName, const char *hookOpts, const char *hookConf, GError **err)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds another hook (plugin) into yaf.  <a href="#a702d0c8b8fc08d6c394d886b6e72717a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#ac5a6f425b4afc915f6163b5d5d1f85d5">yfHookScanPayload</a> (<a class="el" href="structyf_flow__st.html">yfFlow_t</a> *flow, const uint8_t *pkt, size_t caplen, pcre *expression, uint16_t offset, uint16_t elementID, uint16_t applabel)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Specifically if application labeling is enabled for deep packet inspection plugin.  <a href="#ac5a6f425b4afc915f6163b5d5d1f85d5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#a732a95ddea0e0d150ce418261ba1d115">yfHookGetTemplateCount</a> (<a class="el" href="structyf_flow__st.html">yfFlow_t</a> *flow)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the amount of templates to add to the SubtemplateMultiList from all plugins hooked.  <a href="#a732a95ddea0e0d150ce418261ba1d115"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafhooks_8h.html#a9416f3b5e9dcc40e47563622b645e7a9">yfHookFreeLists</a> (<a class="el" href="structyf_flow__st.html">yfFlow_t</a> *flow)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends control back to the plugin to free any BasicLists, SubTemplateLists, or SubTemplateMultiLists that may have been used in it's added templates.  <a href="#a9416f3b5e9dcc40e47563622b645e7a9"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Processing hook interface for YAF. </p>
<p>VERSION 3 - REQUIRES FIXBUF 1.0</p>
<p>The plugin must implement all of the following functions:</p>
<p>ypGetMetaData - returns the version, max export bytes, applabel enabled</p>
<p>ypHookPacket - called by <a class="el" href="yaftab_8h.html#ab37f151a4c4f8428eaf11655ec54be64" title="Add a decoded packet buffer to a given flow table.">yfFlowPBuf()</a></p>
<p>ypFlowPacket - called by <a class="el" href="yaftab_8h.html#ab37f151a4c4f8428eaf11655ec54be64" title="Add a decoded packet buffer to a given flow table.">yfFlowPBuf()</a> and yfAppLabelFlow() when called by yfAppLabelFlow - the last 3 parameters are 0</p>
<p>ypFlowClose - called by yfFlowClose()</p>
<p>ypFlowAlloc - called by yfFlowGetNode()</p>
<p>ypFlowFree - called by yfFlowFree()</p>
<p>ypGetInfoModel - called by yfInfoModel() - this should not be used for v.3</p>
<p>ypGetTemplate - called by yfInitExporterSession()</p>
<p>ypSetPluginOpt - called by <a class="el" href="yafhooks_8h.html#a702d0c8b8fc08d6c394d886b6e72717a" title="Adds another hook (plugin) into yaf.">yfHookAddNewHook()</a></p>
<p>ypSetPluginConf - called by <a class="el" href="yafhooks_8h.html#a702d0c8b8fc08d6c394d886b6e72717a" title="Adds another hook (plugin) into yaf.">yfHookAddNewHook()</a></p>
<p>ypScanPayload - if Application labeling is enabled, called by app plugins</p>
<p>ypValidateFlowTab - called by <a class="el" href="yaftab_8h.html#ab0ebee7bcc281fe6dfad318463da234a" title="yfFlowTabAlloc">yfFlowTabAlloc()</a></p>
<p>ypGetTemplateCount - called by <a class="el" href="yafcore_8h.html#a4aba445d9e6561395ee1a2de5a91ac15" title="Write a single flow to an IPFIX message buffer.">yfWriteFlow()</a></p>
<p>ypFreeLists - called by <a class="el" href="yafcore_8h.html#a4aba445d9e6561395ee1a2de5a91ac15" title="Write a single flow to an IPFIX message buffer.">yfWriteFlow()</a> </p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a702d0c8b8fc08d6c394d886b6e72717a"></a><!-- doxytag: member="yafhooks.h::yfHookAddNewHook" ref="a702d0c8b8fc08d6c394d886b6e72717a" args="(const char *hookName, const char *hookOpts, const char *hookConf, GError **err)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean yfHookAddNewHook </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>hookName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>hookOpts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>hookConf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GError **&nbsp;</td>
          <td class="paramname"> <em>err</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds another hook (plugin) into yaf. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>hookName</em>&nbsp;</td><td>the file name of the plugin to load </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>hookOpts</em>&nbsp;</td><td>a string of command line options for the plugin to process </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>hookConf</em>&nbsp;</td><td>the config file for the plugin </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>err</em>&nbsp;</td><td>the error value that gets set if this call didn't work</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE if plugin loaded fine, other FALSE </dd></dl>

</div>
</div>
<a class="anchor" id="a26154d71d6f5e035bd8f7f31c7af81c2"></a><!-- doxytag: member="yafhooks.h::yfHookFlowAlloc" ref="a26154d71d6f5e035bd8f7f31c7af81c2" args="(yfFlow_t *flow)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yfHookFlowAlloc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyf_flow__st.html">yfFlow_t</a> *&nbsp;</td>
          <td class="paramname"> <em>flow</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Allow plugins to allocate flow state information for each flow captured by yaf at the time of flow creation. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>flow</em>&nbsp;</td><td>the pointer to the flow context state structure, but more importantly contains the array of pointers (hfctx) which hold the plugin context state </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a9b801e783cc418a5d6b4625984a9557e"></a><!-- doxytag: member="yafhooks.h::yfHookFlowClose" ref="a9b801e783cc418a5d6b4625984a9557e" args="(yfFlow_t *flow)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean yfHookFlowClose </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyf_flow__st.html">yfFlow_t</a> *&nbsp;</td>
          <td class="paramname"> <em>flow</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Called upon flow close to do any necessary plugin processing upon flow close. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>flow</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE or FALSE upon error </dd></dl>

</div>
</div>
<a class="anchor" id="a0a95321f578ab86b78f7e7c348e2b004"></a><!-- doxytag: member="yafhooks.h::yfHookFlowFree" ref="a0a95321f578ab86b78f7e7c348e2b004" args="(yfFlow_t *flow)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yfHookFlowFree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyf_flow__st.html">yfFlow_t</a> *&nbsp;</td>
          <td class="paramname"> <em>flow</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Frees all memory associated with the flow state in all of the attached plugins. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>flow</em>&nbsp;</td><td>- a pointer to the flow context structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a4e57f87d6a93b48cc0936ae97cd947c3"></a><!-- doxytag: member="yafhooks.h::yfHookFlowPacket" ref="a4e57f87d6a93b48cc0936ae97cd947c3" args="(yfFlow_t *flow, yfFlowVal_t *val, const uint8_t *pkt, size_t caplen, uint16_t iplen, yfTCPInfo_t *tcpinfo, yfL2Info_t *l2info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yfHookFlowPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyf_flow__st.html">yfFlow_t</a> *&nbsp;</td>
          <td class="paramname"> <em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyf_flow_val__st.html">yfFlowVal_t</a> *&nbsp;</td>
          <td class="paramname"> <em>val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&nbsp;</td>
          <td class="paramname"> <em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>caplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&nbsp;</td>
          <td class="paramname"> <em>iplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyf_t_c_p_info__st.html">yfTCPInfo_t</a> *&nbsp;</td>
          <td class="paramname"> <em>tcpinfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyf_l2_info__st.html">yfL2Info_t</a> *&nbsp;</td>
          <td class="paramname"> <em>l2info</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Similar to yfHookPacket but also given yfFlowVal_t struct for processing per flow direction. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>flow</em>&nbsp;</td><td>pointer to yfFlow_t </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>val</em>&nbsp;</td><td>pointer to yfFlowVal_t struct </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pkt</em>&nbsp;</td><td>pointer to pkt data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>caplen</em>&nbsp;</td><td>size of pkt data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iplen</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tcpinfo</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>l2info</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a9416f3b5e9dcc40e47563622b645e7a9"></a><!-- doxytag: member="yafhooks.h::yfHookFreeLists" ref="a9416f3b5e9dcc40e47563622b645e7a9" args="(yfFlow_t *flow)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yfHookFreeLists </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyf_flow__st.html">yfFlow_t</a> *&nbsp;</td>
          <td class="paramname"> <em>flow</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sends control back to the plugin to free any BasicLists, SubTemplateLists, or SubTemplateMultiLists that may have been used in it's added templates. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>flow</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a101e734c147bf121eacdc6e0b7e5487c"></a><!-- doxytag: member="yafhooks.h::yfHookGetInfoModel" ref="a101e734c147bf121eacdc6e0b7e5487c" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fbInfoElement_t* yfHookGetInfoModel </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the IPFIX info model aggregated for all plugins. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>pointer to an array of fbInfoElement_t that contains the sum of the IPFIX IE's from all active plugins </dd></dl>

</div>
</div>
<a class="anchor" id="a3f9d70dbb8a7a2ab72e82977be7b4596"></a><!-- doxytag: member="yafhooks.h::yfHookGetTemplate" ref="a3f9d70dbb8a7a2ab72e82977be7b4596" args="(fbSession_t *session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean yfHookGetTemplate </td>
          <td>(</td>
          <td class="paramtype">fbSession_t *&nbsp;</td>
          <td class="paramname"> <em>session</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Gets the IPFIX info model template for the export data from _all_ the plugins and turns it into a single template to return. </p>
<p>It caches the results so that future queries are a lot faster. It can validate the cached result if the numer of plugins registered changes.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>session</em>&nbsp;</td><td>pointer to an array of fbInfoElementSpec_t structures that describes the info model template </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a732a95ddea0e0d150ce418261ba1d115"></a><!-- doxytag: member="yafhooks.h::yfHookGetTemplateCount" ref="a732a95ddea0e0d150ce418261ba1d115" args="(yfFlow_t *flow)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t yfHookGetTemplateCount </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyf_flow__st.html">yfFlow_t</a> *&nbsp;</td>
          <td class="paramname"> <em>flow</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the amount of templates to add to the SubtemplateMultiList from all plugins hooked. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>flow</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>number of templates to add to SubTemplateMultiList in yaf </dd></dl>

</div>
</div>
<a class="anchor" id="acd19221bcb828e3b205ac1d1bae67dd5"></a><!-- doxytag: member="yafhooks.h::yfHookPacket" ref="acd19221bcb828e3b205ac1d1bae67dd5" args="(yfFlowKey_t *key, const uint8_t *pkt, size_t caplen, uint16_t iplen, yfTCPInfo_t *tcpinfo, yfL2Info_t *l2info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean yfHookPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyf_flow_key__st.html">yfFlowKey_t</a> *&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&nbsp;</td>
          <td class="paramname"> <em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>caplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&nbsp;</td>
          <td class="paramname"> <em>iplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyf_t_c_p_info__st.html">yfTCPInfo_t</a> *&nbsp;</td>
          <td class="paramname"> <em>tcpinfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyf_l2_info__st.html">yfL2Info_t</a> *&nbsp;</td>
          <td class="paramname"> <em>l2info</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Function called to do processing on each packet as it comes in. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>key</em>&nbsp;</td><td>pointer to flowkey </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pkt</em>&nbsp;</td><td>pointer to pkt data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>caplen</em>&nbsp;</td><td>size of pkt data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iplen</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tcpinfo</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>l2info</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE if pkt processing should continue, FALSE if not </dd></dl>

</div>
</div>
<a class="anchor" id="ac5a6f425b4afc915f6163b5d5d1f85d5"></a><!-- doxytag: member="yafhooks.h::yfHookScanPayload" ref="ac5a6f425b4afc915f6163b5d5d1f85d5" args="(yfFlow_t *flow, const uint8_t *pkt, size_t caplen, pcre *expression, uint16_t offset, uint16_t elementID, uint16_t applabel)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yfHookScanPayload </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyf_flow__st.html">yfFlow_t</a> *&nbsp;</td>
          <td class="paramname"> <em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&nbsp;</td>
          <td class="paramname"> <em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>caplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pcre *&nbsp;</td>
          <td class="paramname"> <em>expression</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&nbsp;</td>
          <td class="paramname"> <em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&nbsp;</td>
          <td class="paramname"> <em>elementID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&nbsp;</td>
          <td class="paramname"> <em>applabel</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Specifically if application labeling is enabled for deep packet inspection plugin. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>flow</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pkt</em>&nbsp;</td><td>pointer to payload </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>caplen</em>&nbsp;</td><td>payloadSize </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>expression</em>&nbsp;</td><td>PCRE expression to evaluate against payload </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>offset</em>&nbsp;</td><td>in payload to begin </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>elementID</em>&nbsp;</td><td>label for regex </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>applabel</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a1e73b3cace941e2dc726996453778c60"></a><!-- doxytag: member="yafhooks.h::yfHookValidateFlowTab" ref="a1e73b3cace941e2dc726996453778c60" args="(uint32_t max_payload, gboolean uniflow, gboolean silkmode, gboolean applabelmode, gboolean entropymode, gboolean fingerprintmode, gboolean fpExportMode, gboolean udp_max_payload, uint16_t udp_uniflow_port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yfHookValidateFlowTab </td>
          <td>(</td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>max_payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&nbsp;</td>
          <td class="paramname"> <em>uniflow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&nbsp;</td>
          <td class="paramname"> <em>silkmode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&nbsp;</td>
          <td class="paramname"> <em>applabelmode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&nbsp;</td>
          <td class="paramname"> <em>entropymode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&nbsp;</td>
          <td class="paramname"> <em>fingerprintmode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&nbsp;</td>
          <td class="paramname"> <em>fpExportMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&nbsp;</td>
          <td class="paramname"> <em>udp_max_payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&nbsp;</td>
          <td class="paramname"> <em>udp_uniflow_port</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Validation function to make sure the plugin can and should operate based on the flowtable options. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>max_payload</em>&nbsp;</td><td>value </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>uniflow</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>silkmode</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>applabelmode</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>entropymode</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fingerprintmode</em>&nbsp;</td><td>p0f finger printing mode </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fpExportMode</em>&nbsp;</td><td>handshake header export mode </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>udp_max_payload</em>&nbsp;</td><td>concatenate udp payloads similar to TCP </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>udp_uniflow_port</em>&nbsp;</td><td>export all udp packets if have this src or dst port </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad791565736a87937fd8c4004bf9d7a51"></a><!-- doxytag: member="yafhooks.h::yfWriteFlowHook" ref="ad791565736a87937fd8c4004bf9d7a51" args="(fbSubTemplateMultiList_t *rec, fbSubTemplateMultiListEntry_t *stml, yfFlow_t *flow, GError **err)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean yfWriteFlowHook </td>
          <td>(</td>
          <td class="paramtype">fbSubTemplateMultiList_t *&nbsp;</td>
          <td class="paramname"> <em>rec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fbSubTemplateMultiListEntry_t *&nbsp;</td>
          <td class="paramname"> <em>stml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyf_flow__st.html">yfFlow_t</a> *&nbsp;</td>
          <td class="paramname"> <em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GError **&nbsp;</td>
          <td class="paramname"> <em>err</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>called by yfWriteFlow to add the data from all registered plugins to the outgoing IPFIX record </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rec</em>&nbsp;</td><td>outgoing subTemplateMultiList </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>stml</em>&nbsp;</td><td>Current entry of subTemplateMultiList </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flow</em>&nbsp;</td><td>pointer to the flow context structure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>err</em>&nbsp;</td><td>Error </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div>
      </div><!-- l-content -->
      <div id="l-footer">&copy; 2006-2013 Carnegie Mellon University</div>
    </div><!-- p-body -->
</body>
</html>   
