<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>YAF - Documentation</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />

        <link rel="stylesheet" type="text/css" href="../../site/style.css" />
        <link rel="stylesheet" type="text/css" href="doxygen.css">
        <link rel="stylesheet" type="text/css" href="tabs.css">
</head>
<body>
    <div id="p-body">
      <div id="l-header">
        <img src="../../site/sei-logo.png" id="l-sei-logo"
            alt="Software Engineering Institute | Carnegie Mellon&copy;" />
        <div id="l-netsa-logo"><a id="l-netsa-name" href="../../index.html"><b>CERT NetSA Security Suite</b></a></div>
        <div id="l-netsa-motto">Monitoring for Large-Scale Networks</div>
        <h1 class="l-page-title">YAF</h1>
        <span id="l-subtitle">Documentation</span>
      </div><!-- l-header -->
      <div id="l-content">
        <div id="l-sidebar">
          <div class="p-sidebar-section">
            <h1><a href="index.html">YAF</a></h1>
            <ul>
              <li><a href="../docs.html">Documentation</a></li>
              <li><a href="../download.html">Downloads</a></li>
            </ul>
          </div><!-- p-sidebar-section -->
        </div><!-- l-sidebar -->
<!-- Generated by Doxygen 1.6.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>yafcore.h File Reference</h1>
<p>YAF Core Library.  
<a href="#_details">More...</a></p>
<code>#include &lt;yaf/autoinc.h&gt;</code><br/>
<code>#include &lt;fixbuf/public.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>

<p><a href="yafcore_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structyf_flow_key__st.html">yfFlowKey_st</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A YAF flow key.  <a href="structyf_flow_key__st.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structyf_flow_stats__st.html">yfFlowStats_st</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">yaf flow statistics  <a href="structyf_flow_stats__st.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structyf_flow_val__st.html">yfFlowVal_st</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A YAF uniflow value.  <a href="structyf_flow_val__st.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structyf_flow__st.html">yfFlow_st</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A YAF flow.  <a href="structyf_flow__st.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4e870a7230abc740fa814dda775d8c6e"></a><!-- doxytag: member="yafcore.h::CERT_PEN" ref="a4e870a7230abc740fa814dda775d8c6e" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a4e870a7230abc740fa814dda775d8c6e">CERT_PEN</a>&nbsp;&nbsp;&nbsp;6871</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This is the CERT Private Enterprise Number (PEN) assigned by IANA, used to define our enterprise data elements to extend IPFIX RFC 5103 data model. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a90bf8a39a94f6927eccf237b681308d7">YAF_ERROR_DOMAIN</a>&nbsp;&nbsp;&nbsp;(g_quark_from_string(&quot;certYAFError&quot;))</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">GError domain for YAF errors.  <a href="#a90bf8a39a94f6927eccf237b681308d7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#aca5a2f530d778e1f7f1f4973a278a2f6">YAF_ERROR_HEADER</a>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A YAF file header was malformed.  <a href="#aca5a2f530d778e1f7f1f4973a278a2f6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a6282c576b6fc85c037ec4ea6944f8c58">YAF_ERROR_ARGUMENT</a>&nbsp;&nbsp;&nbsp;2</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Illegal argument error.  <a href="#a6282c576b6fc85c037ec4ea6944f8c58"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a676a9aa996fbb642eabbe13196f1dd91"></a><!-- doxytag: member="yafcore.h::YAF_ERROR_IO" ref="a676a9aa996fbb642eabbe13196f1dd91" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a676a9aa996fbb642eabbe13196f1dd91">YAF_ERROR_IO</a>&nbsp;&nbsp;&nbsp;3</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">General I/O error. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a671b4e1cc3bca4f38a5d55cbec210528">YAF_ERROR_IPFIX</a>&nbsp;&nbsp;&nbsp;4</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">YAF could not accept IPFIX input due to missing fields.  <a href="#a671b4e1cc3bca4f38a5d55cbec210528"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adbc8dc3f90ea1cdd17e7d9087f0a9193"></a><!-- doxytag: member="yafcore.h::YAF_ERROR_IMPL" ref="adbc8dc3f90ea1cdd17e7d9087f0a9193" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#adbc8dc3f90ea1cdd17e7d9087f0a9193">YAF_ERROR_IMPL</a>&nbsp;&nbsp;&nbsp;5</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Requested feature is not available. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a73e744837dbf0dafb0b3a81a482c4b4b"></a><!-- doxytag: member="yafcore.h::YAF_ERROR_INTERNAL" ref="a73e744837dbf0dafb0b3a81a482c4b4b" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a73e744837dbf0dafb0b3a81a482c4b4b">YAF_ERROR_INTERNAL</a>&nbsp;&nbsp;&nbsp;6</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Internal error occured (aka a bug). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9d90d371e4eadbd2372964d75db45553"></a><!-- doxytag: member="yafcore.h::YAF_ERROR_LIMIT" ref="a9d90d371e4eadbd2372964d75db45553" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a9d90d371e4eadbd2372964d75db45553">YAF_ERROR_LIMIT</a>&nbsp;&nbsp;&nbsp;7</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Hard program limit reached. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a518d378ce28866a23bbeb14b247f3441"></a><!-- doxytag: member="yafcore.h::YAF_ERROR_EOF" ref="a518d378ce28866a23bbeb14b247f3441" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a518d378ce28866a23bbeb14b247f3441">YAF_ERROR_EOF</a>&nbsp;&nbsp;&nbsp;8</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">End of file. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2225e5d104fbced4de6fdf219f1d795b"></a><!-- doxytag: member="yafcore.h::YAF_ERROR_ALIGNMENT" ref="a2225e5d104fbced4de6fdf219f1d795b" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a2225e5d104fbced4de6fdf219f1d795b">YAF_ERROR_ALIGNMENT</a>&nbsp;&nbsp;&nbsp;9</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Internal alignment error. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae9f63276eb8f1e2e1ebfd2dd20cf2abb"></a><!-- doxytag: member="yafcore.h::YAF_ERROR_PACKET_PAYLOAD" ref="ae9f63276eb8f1e2e1ebfd2dd20cf2abb" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#ae9f63276eb8f1e2e1ebfd2dd20cf2abb">YAF_ERROR_PACKET_PAYLOAD</a>&nbsp;&nbsp;&nbsp;10</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Packet payload processing error. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a748ec2ae26f407ac851800cdd787a552">YAF_FLOW_ACTIVE</a>&nbsp;&nbsp;&nbsp;0</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pseudo end reason for flows still active during collection.  <a href="#a748ec2ae26f407ac851800cdd787a552"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a2e1f8e4daf657da7126bd7986182ec25">YAF_END_IDLE</a>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Flow ended due to idle timeout.  <a href="#a2e1f8e4daf657da7126bd7986182ec25"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a7594540d5d2cdf742926790b59d18b1a">YAF_END_ACTIVE</a>&nbsp;&nbsp;&nbsp;2</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Flow ended due to active timeout.  <a href="#a7594540d5d2cdf742926790b59d18b1a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a8a00d70c7f0428edc3d7b1052cc1874c">YAF_END_CLOSED</a>&nbsp;&nbsp;&nbsp;3</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Flow ended due to FIN or RST close.  <a href="#a8a00d70c7f0428edc3d7b1052cc1874c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#adc3ad71ab8c519b50a668b5355d1fa49">YAF_END_FORCED</a>&nbsp;&nbsp;&nbsp;4</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Flow ended due to YAF shutdown.  <a href="#adc3ad71ab8c519b50a668b5355d1fa49"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a7dd7519c1766797ccb4a4de0db11860b">YAF_END_RESOURCE</a>&nbsp;&nbsp;&nbsp;5</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Flow flushed due to YAF resource exhaustion.  <a href="#a7dd7519c1766797ccb4a4de0db11860b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a416127276f04d95e28b15f018ae9196d">YAF_END_UDPFORCE</a>&nbsp;&nbsp;&nbsp;0x1F</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Flow flushed due to udp-uniflow on all or selected ports.  <a href="#a416127276f04d95e28b15f018ae9196d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af797d04660c7f352b5c6fe8faf325fe6"></a><!-- doxytag: member="yafcore.h::YAF_SAME_SIZE" ref="af797d04660c7f352b5c6fe8faf325fe6" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#af797d04660c7f352b5c6fe8faf325fe6">YAF_SAME_SIZE</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Flow has same size packets in this direction. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad0924e9fd97124c7f992e8bda2ac3df0"></a><!-- doxytag: member="yafcore.h::YAF_OUT_OF_SEQUENCE" ref="ad0924e9fd97124c7f992e8bda2ac3df0" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#ad0924e9fd97124c7f992e8bda2ac3df0">YAF_OUT_OF_SEQUENCE</a>&nbsp;&nbsp;&nbsp;0x02</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Flow was processed out of sequence. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a741d946a09ea41f01d32f1bb770d0003"></a><!-- doxytag: member="yafcore.h::YAF_FRAG_ACTIVE" ref="a741d946a09ea41f01d32f1bb770d0003" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a741d946a09ea41f01d32f1bb770d0003">YAF_FRAG_ACTIVE</a>&nbsp;&nbsp;&nbsp;0x03</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Flow has fragments that have reached active timeout. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4305f7e14741c460ec98b000e6d96815"></a><!-- doxytag: member="yafcore.h::YAF_FRAG_PASSIVE" ref="a4305f7e14741c460ec98b000e6d96815" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a4305f7e14741c460ec98b000e6d96815">YAF_FRAG_PASSIVE</a>&nbsp;&nbsp;&nbsp;0x04</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Flow has fragments that have reached passive timeout. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab0a3726fe7960f4bea91466c930904ea"></a><!-- doxytag: member="yafcore.h::YAF_END_MASK" ref="ab0a3726fe7960f4bea91466c930904ea" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#ab0a3726fe7960f4bea91466c930904ea">YAF_END_MASK</a>&nbsp;&nbsp;&nbsp;0x7F</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Flow reason mask. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae912d9a7f9cf3ff896f5ba9e849f1e66"></a><!-- doxytag: member="yafcore.h::YAF_ENDF_ISCONT" ref="ae912d9a7f9cf3ff896f5ba9e849f1e66" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#ae912d9a7f9cf3ff896f5ba9e849f1e66">YAF_ENDF_ISCONT</a>&nbsp;&nbsp;&nbsp;0x80</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">SiLK mode flow reason flag - flow was created after active termination. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1fb7c588d476dd7dacff04b6f2b87fd8"></a><!-- doxytag: member="yafcore.h::YAF_IP_ICMP" ref="a1fb7c588d476dd7dacff04b6f2b87fd8" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a1fb7c588d476dd7dacff04b6f2b87fd8">YAF_IP_ICMP</a>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">IP protocol identifier for ICMP. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6ddac667f4893f825b2c36f439cf2d25"></a><!-- doxytag: member="yafcore.h::YAF_IP_TCP" ref="a6ddac667f4893f825b2c36f439cf2d25" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a6ddac667f4893f825b2c36f439cf2d25">YAF_IP_TCP</a>&nbsp;&nbsp;&nbsp;6</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">IP protocol identifier for TCP. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1bfb66639fbd610af657911ed5de5a06"></a><!-- doxytag: member="yafcore.h::YAF_IP_UDP" ref="a1bfb66639fbd610af657911ed5de5a06" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a1bfb66639fbd610af657911ed5de5a06">YAF_IP_UDP</a>&nbsp;&nbsp;&nbsp;17</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">IP protocol identifier for UDP. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a44c00594ac34eb99ead87136ff390093"></a><!-- doxytag: member="yafcore.h::YFP_IPTCPHEADER_SIZE" ref="a44c00594ac34eb99ead87136ff390093" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a44c00594ac34eb99ead87136ff390093">YFP_IPTCPHEADER_SIZE</a>&nbsp;&nbsp;&nbsp;128</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This is the size of the packet to store away for use primarily in passive OS fingerprinting, this value is only used if application labeling is enabled. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9dcda5832463d24a4f46a5e646121892"></a><!-- doxytag: member="yafcore.h::ETHERNET_MAC_ADDR_LENGTH" ref="a9dcda5832463d24a4f46a5e646121892" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a9dcda5832463d24a4f46a5e646121892">ETHERNET_MAC_ADDR_LENGTH</a>&nbsp;&nbsp;&nbsp;6</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">length of Ethernet MAC Address <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2395ccdd70f26be0ecef94cca543efda"></a><!-- doxytag: member="yafcore.h::YAF_MAX_HOOKS" ref="a2395ccdd70f26be0ecef94cca543efda" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a2395ccdd70f26be0ecef94cca543efda">YAF_MAX_HOOKS</a>&nbsp;&nbsp;&nbsp;4</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">maximum number of hooks (plugins) allowed at one time <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa02f9275b48945fbb8ef55058be71f6c"></a><!-- doxytag: member="yafcore.h::YAF_HOOKS_MAX_EXPORT" ref="aa02f9275b48945fbb8ef55058be71f6c" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#aa02f9275b48945fbb8ef55058be71f6c">YAF_HOOKS_MAX_EXPORT</a>&nbsp;&nbsp;&nbsp;1500</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">this is the maximum amount of data that the plugins may export in sum total <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9a096b81cc71a4436967322b1dea4994"></a><!-- doxytag: member="yafcore.h::YAF_MAX_PKT_BOUNDARY" ref="a9a096b81cc71a4436967322b1dea4994" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a9a096b81cc71a4436967322b1dea4994">YAF_MAX_PKT_BOUNDARY</a>&nbsp;&nbsp;&nbsp;25</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Maximum Number of Packet Boundaries to keep around per payload. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a93d6a419db9b3f4d638d664a5c897691"></a><!-- doxytag: member="yafcore.h::YAF_PCAP_MAX" ref="a93d6a419db9b3f4d638d664a5c897691" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a93d6a419db9b3f4d638d664a5c897691">YAF_PCAP_MAX</a>&nbsp;&nbsp;&nbsp;5000000</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Maximum length of PCAP output file - 5MB. <br/></td></tr>
<tr><td colspan="2"><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structyf_flow_key__st.html">yfFlowKey_st</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a772bfd1d76b8f135ed7fcaf59468eb7b">yfFlowKey_t</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A YAF flow key.  <a href="#a772bfd1d76b8f135ed7fcaf59468eb7b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6708ad7aa328559775b237c5effaac27"></a><!-- doxytag: member="yafcore.h::yfFlowStats_t" ref="a6708ad7aa328559775b237c5effaac27" args="" -->
typedef struct <a class="el" href="structyf_flow_stats__st.html">yfFlowStats_st</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a6708ad7aa328559775b237c5effaac27">yfFlowStats_t</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">yaf flow statistics <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structyf_flow_val__st.html">yfFlowVal_st</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#ac37f5df551c6f2d381848399300f6722">yfFlowVal_t</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A YAF uniflow value.  <a href="#ac37f5df551c6f2d381848399300f6722"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structyf_flow__st.html">yfFlow_st</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a65678110dc9767958969a4f57bf801ba">yfFlow_t</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A YAF flow.  <a href="#a65678110dc9767958969a4f57bf801ba"></a><br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a68a8f1cdca0c20efb8bce1dd0e6917c1">yfAlignmentCheck</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">yfAlignmentCheck  <a href="#a68a8f1cdca0c20efb8bce1dd0e6917c1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a96a23294d877e529cacc564bb3a51488">yfFlowPrepare</a> (<a class="el" href="structyf_flow__st.html">yfFlow_t</a> *flow)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Prepare a static flow buffer for use with yaf_flow_read().  <a href="#a96a23294d877e529cacc564bb3a51488"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a771c185221c27f7b69374c40b208a0e3">yfFlowCleanup</a> (<a class="el" href="structyf_flow__st.html">yfFlow_t</a> *flow)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clean up after a static flow buffer prepared by yfFlowPrepare.  <a href="#a771c185221c27f7b69374c40b208a0e3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">fBuf_t *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a1422ae5d15ad994a6e2e3fd40816c609">yfWriterForFile</a> (const char *path, uint32_t domain, GError **err)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get an IPFIX message buffer for writing YAF flows to a named file.  <a href="#a1422ae5d15ad994a6e2e3fd40816c609"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">fBuf_t *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a753d03baaddfb6432f85f548c7afe683">yfWriterForFP</a> (FILE *fp, uint32_t domain, GError **err)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get an IPFIX message buffer for writing YAF flows to an open file pointer.  <a href="#a753d03baaddfb6432f85f548c7afe683"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">fBuf_t *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a3c20540b8763c574b8a9c660f5b70972">yfWriterForSpec</a> (fbConnSpec_t *spec, uint32_t domain, GError **err)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get an IPFIX message buffer for writing YAF flows to a socket.  <a href="#a3c20540b8763c574b8a9c660f5b70972"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gboolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#aad688e7ab8e1c8a7c221db81b8b4ab9b">yfWriteStatsFlow</a> (void *yfContext, uint32_t pcap_drop, GTimer *timer, GError **err)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write an options data record to an IPFIX Message buffer.  <a href="#aad688e7ab8e1c8a7c221db81b8b4ab9b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gboolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a4aba445d9e6561395ee1a2de5a91ac15">yfWriteFlow</a> (void *yfContext, <a class="el" href="structyf_flow__st.html">yfFlow_t</a> *flow, GError **err)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write a single flow to an IPFIX message buffer.  <a href="#a4aba445d9e6561395ee1a2de5a91ac15"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gboolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#ace9d2497ad9dfacc3abb8cc20a95492b">yfWriterClose</a> (fBuf_t *fbuf, gboolean flush, GError **err)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Close the connection underlying an IPFIX message buffer created by <a class="el" href="yafcore_8h.html#a753d03baaddfb6432f85f548c7afe683" title="Get an IPFIX message buffer for writing YAF flows to an open file pointer.">yfWriterForFP()</a> or <a class="el" href="yafcore_8h.html#a3c20540b8763c574b8a9c660f5b70972" title="Get an IPFIX message buffer for writing YAF flows to a socket.">yfWriterForSpec()</a>.  <a href="#ace9d2497ad9dfacc3abb8cc20a95492b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2c400aa5f56422c958f8172bf4e1802e"></a><!-- doxytag: member="yafcore.h::yfWriterExportPayload" ref="a2c400aa5f56422c958f8172bf4e1802e" args="(gboolean payload_mode)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a2c400aa5f56422c958f8172bf4e1802e">yfWriterExportPayload</a> (gboolean payload_mode)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">FIXME doc. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acf608a94a2469d3b6777c3b92aa9937e"></a><!-- doxytag: member="yafcore.h::yfWriterExportMappedV6" ref="acf608a94a2469d3b6777c3b92aa9937e" args="(gboolean map_mode)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#acf608a94a2469d3b6777c3b92aa9937e">yfWriterExportMappedV6</a> (gboolean map_mode)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">FIXME doc. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">fBuf_t *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a17ef8e5b972e0ec36d372a703604c85f">yfReaderForFP</a> (fBuf_t *fbuf, FILE *fp, GError **err)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get an IPFIX message buffer for reading YAF flows from an open file pointer.  <a href="#a17ef8e5b972e0ec36d372a703604c85f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">fbListener_t *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a99e3f8d2e81765581ee143c1e5b77571">yfListenerForSpec</a> (fbConnSpec_t *spec, fbListenerAppInit_fn appinit, fbListenerAppFree_fn appfree, GError **err)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get an IPFIX connection listener for collecting YAF flows via IPFIX from the network.  <a href="#a99e3f8d2e81765581ee143c1e5b77571"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gboolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a4916880e1835ed3bc8d2912791076caf">yfReadFlow</a> (fBuf_t *fbuf, <a class="el" href="structyf_flow__st.html">yfFlow_t</a> *flow, GError **err)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read a single flow from an IPFIX message buffer.  <a href="#a4916880e1835ed3bc8d2912791076caf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gboolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a2508ff2b0d463c2689e382e4b46bc167">yfReadFlowExtended</a> (fBuf_t *fbuf, <a class="el" href="structyf_flow__st.html">yfFlow_t</a> *flow, GError **err)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read a single flow from an IPFIX message buffer.  <a href="#a2508ff2b0d463c2689e382e4b46bc167"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a65663f982cb1eec1717c9608584c2ff0">yfPrintString</a> (GString *rstr, <a class="el" href="structyf_flow__st.html">yfFlow_t</a> *flow)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print a YAF flow to a GString.  <a href="#a65663f982cb1eec1717c9608584c2ff0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a7320f2e7a349df396c09ebfccbb9311a">yfPrintDelimitedString</a> (GString *rstr, <a class="el" href="structyf_flow__st.html">yfFlow_t</a> *flow, gboolean yaft_mac)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print a YAF flow to a GString in pipe-delimited (tabular) format.  <a href="#a7320f2e7a349df396c09ebfccbb9311a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gboolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#a84556dc608d472f7efa5c7a22a1ed714">yfPrint</a> (FILE *out, <a class="el" href="structyf_flow__st.html">yfFlow_t</a> *flow, GError **err)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print a YAF flow to a file.  <a href="#a84556dc608d472f7efa5c7a22a1ed714"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gboolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#ac67f74d1debf3a8af50537cfa714fd2b">yfPrintDelimited</a> (FILE *out, <a class="el" href="structyf_flow__st.html">yfFlow_t</a> *flow, gboolean yaft_mac, GError **err)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print a YAF flow to a file in pipe-delimited (tabular) format.  <a href="#ac67f74d1debf3a8af50537cfa714fd2b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#ad77e6ac6049bf5feb7c9d4c2430a4ce1">yfPrintColumnHeaders</a> (FILE *out, gboolean yaft_mac, GError **err)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print column headers for the pipe-delimited (tabular) format.  <a href="#ad77e6ac6049bf5feb7c9d4c2430a4ce1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">fbInfoModel_t *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="yafcore_8h.html#aade4fd5f0fc6af19135540d538904ce6">yfDPIInfoModel</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add all DPI info elements to info model.  <a href="#aade4fd5f0fc6af19135540d538904ce6"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>YAF Core Library. </p>
<p>Defines API for reading and writing YAF files, and the yfFlow_t data structures. </p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a7594540d5d2cdf742926790b59d18b1a"></a><!-- doxytag: member="yafcore.h::YAF_END_ACTIVE" ref="a7594540d5d2cdf742926790b59d18b1a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define YAF_END_ACTIVE&nbsp;&nbsp;&nbsp;2</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Flow ended due to active timeout. </p>

</div>
</div>
<a class="anchor" id="a8a00d70c7f0428edc3d7b1052cc1874c"></a><!-- doxytag: member="yafcore.h::YAF_END_CLOSED" ref="a8a00d70c7f0428edc3d7b1052cc1874c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define YAF_END_CLOSED&nbsp;&nbsp;&nbsp;3</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Flow ended due to FIN or RST close. </p>

</div>
</div>
<a class="anchor" id="adc3ad71ab8c519b50a668b5355d1fa49"></a><!-- doxytag: member="yafcore.h::YAF_END_FORCED" ref="adc3ad71ab8c519b50a668b5355d1fa49" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define YAF_END_FORCED&nbsp;&nbsp;&nbsp;4</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Flow ended due to YAF shutdown. </p>

</div>
</div>
<a class="anchor" id="a2e1f8e4daf657da7126bd7986182ec25"></a><!-- doxytag: member="yafcore.h::YAF_END_IDLE" ref="a2e1f8e4daf657da7126bd7986182ec25" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define YAF_END_IDLE&nbsp;&nbsp;&nbsp;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Flow ended due to idle timeout. </p>

</div>
</div>
<a class="anchor" id="a7dd7519c1766797ccb4a4de0db11860b"></a><!-- doxytag: member="yafcore.h::YAF_END_RESOURCE" ref="a7dd7519c1766797ccb4a4de0db11860b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define YAF_END_RESOURCE&nbsp;&nbsp;&nbsp;5</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Flow flushed due to YAF resource exhaustion. </p>

</div>
</div>
<a class="anchor" id="a416127276f04d95e28b15f018ae9196d"></a><!-- doxytag: member="yafcore.h::YAF_END_UDPFORCE" ref="a416127276f04d95e28b15f018ae9196d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define YAF_END_UDPFORCE&nbsp;&nbsp;&nbsp;0x1F</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Flow flushed due to udp-uniflow on all or selected ports. </p>

</div>
</div>
<a class="anchor" id="a6282c576b6fc85c037ec4ea6944f8c58"></a><!-- doxytag: member="yafcore.h::YAF_ERROR_ARGUMENT" ref="a6282c576b6fc85c037ec4ea6944f8c58" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define YAF_ERROR_ARGUMENT&nbsp;&nbsp;&nbsp;2</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Illegal argument error. </p>

</div>
</div>
<a class="anchor" id="a90bf8a39a94f6927eccf237b681308d7"></a><!-- doxytag: member="yafcore.h::YAF_ERROR_DOMAIN" ref="a90bf8a39a94f6927eccf237b681308d7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define YAF_ERROR_DOMAIN&nbsp;&nbsp;&nbsp;(g_quark_from_string(&quot;certYAFError&quot;))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>GError domain for YAF errors. </p>
<p>All YAF errors belong to this domain. In addition, YAF core library routines can return libfixbuf errors if reading or writing fails. </p>

</div>
</div>
<a class="anchor" id="aca5a2f530d778e1f7f1f4973a278a2f6"></a><!-- doxytag: member="yafcore.h::YAF_ERROR_HEADER" ref="aca5a2f530d778e1f7f1f4973a278a2f6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define YAF_ERROR_HEADER&nbsp;&nbsp;&nbsp;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>A YAF file header was malformed. </p>
<p>The file is probably not a YAF file. </p>

</div>
</div>
<a class="anchor" id="a671b4e1cc3bca4f38a5d55cbec210528"></a><!-- doxytag: member="yafcore.h::YAF_ERROR_IPFIX" ref="a671b4e1cc3bca4f38a5d55cbec210528" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define YAF_ERROR_IPFIX&nbsp;&nbsp;&nbsp;4</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>YAF could not accept IPFIX input due to missing fields. </p>

</div>
</div>
<a class="anchor" id="a748ec2ae26f407ac851800cdd787a552"></a><!-- doxytag: member="yafcore.h::YAF_FLOW_ACTIVE" ref="a748ec2ae26f407ac851800cdd787a552" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define YAF_FLOW_ACTIVE&nbsp;&nbsp;&nbsp;0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pseudo end reason for flows still active during collection. </p>
<p>Not valid on disk. </p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="a65678110dc9767958969a4f57bf801ba"></a><!-- doxytag: member="yafcore.h::yfFlow_t" ref="a65678110dc9767958969a4f57bf801ba" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structyf_flow__st.html">yfFlow_st</a>  <a class="el" href="structyf_flow__st.html">yfFlow_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>A YAF flow. </p>
<p>Joins a flow key with forward and reverse flow values in time.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>if you edit the layout of this structure, you must make a corresponding edit of the yfFlowIPv4_t structure in yaftab.c </dd></dl>

</div>
</div>
<a class="anchor" id="a772bfd1d76b8f135ed7fcaf59468eb7b"></a><!-- doxytag: member="yafcore.h::yfFlowKey_t" ref="a772bfd1d76b8f135ed7fcaf59468eb7b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structyf_flow_key__st.html">yfFlowKey_st</a>  <a class="el" href="structyf_flow_key__st.html">yfFlowKey_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>A YAF flow key. </p>
<p>Contains a flow's five-tuple; used at runtime in the flow table. </p>

</div>
</div>
<a class="anchor" id="ac37f5df551c6f2d381848399300f6722"></a><!-- doxytag: member="yafcore.h::yfFlowVal_t" ref="ac37f5df551c6f2d381848399300f6722" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structyf_flow_val__st.html">yfFlowVal_st</a>  <a class="el" href="structyf_flow_val__st.html">yfFlowVal_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>A YAF uniflow value. </p>
<p>Contains directional packet header fields and counters; two of these are used to build a biflow. </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a68a8f1cdca0c20efb8bce1dd0e6917c1"></a><!-- doxytag: member="yafcore.h::yfAlignmentCheck" ref="a68a8f1cdca0c20efb8bce1dd0e6917c1" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yfAlignmentCheck </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>yfAlignmentCheck </p>
<p>This is a purely internal diagnostic function. It checks the alignment of the internal data structures that are used with fixbuf and causes the program to abort if there is an alignment issue. </p>

</div>
</div>
<a class="anchor" id="aade4fd5f0fc6af19135540d538904ce6"></a><!-- doxytag: member="yafcore.h::yfDPIInfoModel" ref="aade4fd5f0fc6af19135540d538904ce6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fbInfoModel_t* yfDPIInfoModel </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add all DPI info elements to info model. </p>

</div>
</div>
<a class="anchor" id="a771c185221c27f7b69374c40b208a0e3"></a><!-- doxytag: member="yafcore.h::yfFlowCleanup" ref="a771c185221c27f7b69374c40b208a0e3" args="(yfFlow_t *flow)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yfFlowCleanup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyf_flow__st.html">yfFlow_t</a> *&nbsp;</td>
          <td class="paramname"> <em>flow</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Clean up after a static flow buffer prepared by yfFlowPrepare. </p>
<p>This is used to free storage for payload information.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>flow</em>&nbsp;</td><td>a yfFlow_t to free </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a96a23294d877e529cacc564bb3a51488"></a><!-- doxytag: member="yafcore.h::yfFlowPrepare" ref="a96a23294d877e529cacc564bb3a51488" args="(yfFlow_t *flow)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yfFlowPrepare </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structyf_flow__st.html">yfFlow_t</a> *&nbsp;</td>
          <td class="paramname"> <em>flow</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Prepare a static flow buffer for use with yaf_flow_read(). </p>
<p>Call this before the first yaf_flow_read() call; subsequent reads do not need initialization. This is used to prepare storage for payload information.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>flow</em>&nbsp;</td><td>a yfFlow_t to initialize </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a99e3f8d2e81765581ee143c1e5b77571"></a><!-- doxytag: member="yafcore.h::yfListenerForSpec" ref="a99e3f8d2e81765581ee143c1e5b77571" args="(fbConnSpec_t *spec, fbListenerAppInit_fn appinit, fbListenerAppFree_fn appfree, GError **err)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fbListener_t* yfListenerForSpec </td>
          <td>(</td>
          <td class="paramtype">fbConnSpec_t *&nbsp;</td>
          <td class="paramname"> <em>spec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fbListenerAppInit_fn&nbsp;</td>
          <td class="paramname"> <em>appinit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fbListenerAppFree_fn&nbsp;</td>
          <td class="paramname"> <em>appfree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GError **&nbsp;</td>
          <td class="paramname"> <em>err</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get an IPFIX connection listener for collecting YAF flows via IPFIX from the network. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>spec</em>&nbsp;</td><td>fixbuf connection specifier for local end of socket. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>appinit</em>&nbsp;</td><td>Application context initialization function, for creating application-specific collector contexts. Pass NULL for no appinit function. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>appfree</em>&nbsp;</td><td>Application context cleanup function. Pass NULL for no appfree function. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>err</em>&nbsp;</td><td>an error description, set on failure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a new listener, initialized for reading YAF flows, for use with fbListenerWait(). Buffers returned from this call can then be used with <a class="el" href="yafcore_8h.html#a4916880e1835ed3bc8d2912791076caf" title="Read a single flow from an IPFIX message buffer.">yfReadFlow()</a> and <a class="el" href="yafcore_8h.html#a2508ff2b0d463c2689e382e4b46bc167" title="Read a single flow from an IPFIX message buffer.">yfReadFlowExtended()</a>. </dd></dl>

</div>
</div>
<a class="anchor" id="a84556dc608d472f7efa5c7a22a1ed714"></a><!-- doxytag: member="yafcore.h::yfPrint" ref="a84556dc608d472f7efa5c7a22a1ed714" args="(FILE *out, yfFlow_t *flow, GError **err)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean yfPrint </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyf_flow__st.html">yfFlow_t</a> *&nbsp;</td>
          <td class="paramname"> <em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GError **&nbsp;</td>
          <td class="paramname"> <em>err</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Print a YAF flow to a file. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>out</em>&nbsp;</td><td>file to print to. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flow</em>&nbsp;</td><td>flow to print. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>err</em>&nbsp;</td><td>an error descriptor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE on success, FALSE otherwise. </dd></dl>

</div>
</div>
<a class="anchor" id="ad77e6ac6049bf5feb7c9d4c2430a4ce1"></a><!-- doxytag: member="yafcore.h::yfPrintColumnHeaders" ref="ad77e6ac6049bf5feb7c9d4c2430a4ce1" args="(FILE *out, gboolean yaft_mac, GError **err)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yfPrintColumnHeaders </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&nbsp;</td>
          <td class="paramname"> <em>yaft_mac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GError **&nbsp;</td>
          <td class="paramname"> <em>err</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Print column headers for the pipe-delimited (tabular) format. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>out</em>&nbsp;</td><td>file to print to. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>yaft_mac</em>&nbsp;</td><td>print mac address column headers if enabled </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>err</em>&nbsp;</td><td>an error descriptor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE on success, FALSE otherwise. </dd></dl>

</div>
</div>
<a class="anchor" id="ac67f74d1debf3a8af50537cfa714fd2b"></a><!-- doxytag: member="yafcore.h::yfPrintDelimited" ref="ac67f74d1debf3a8af50537cfa714fd2b" args="(FILE *out, yfFlow_t *flow, gboolean yaft_mac, GError **err)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean yfPrintDelimited </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyf_flow__st.html">yfFlow_t</a> *&nbsp;</td>
          <td class="paramname"> <em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&nbsp;</td>
          <td class="paramname"> <em>yaft_mac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GError **&nbsp;</td>
          <td class="paramname"> <em>err</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Print a YAF flow to a file in pipe-delimited (tabular) format. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>out</em>&nbsp;</td><td>file to print to. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flow</em>&nbsp;</td><td>flow to print. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>yaft_mac</em>&nbsp;</td><td>print mac addresses in tabular format </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>err</em>&nbsp;</td><td>an error descriptor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE on success, FALSE otherwise. </dd></dl>

</div>
</div>
<a class="anchor" id="a7320f2e7a349df396c09ebfccbb9311a"></a><!-- doxytag: member="yafcore.h::yfPrintDelimitedString" ref="a7320f2e7a349df396c09ebfccbb9311a" args="(GString *rstr, yfFlow_t *flow, gboolean yaft_mac)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yfPrintDelimitedString </td>
          <td>(</td>
          <td class="paramtype">GString *&nbsp;</td>
          <td class="paramname"> <em>rstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyf_flow__st.html">yfFlow_t</a> *&nbsp;</td>
          <td class="paramname"> <em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&nbsp;</td>
          <td class="paramname"> <em>yaft_mac</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Print a YAF flow to a GString in pipe-delimited (tabular) format. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rstr</em>&nbsp;</td><td>string to append text representation of flow to. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flow</em>&nbsp;</td><td>flow to print. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>yaft_mac</em>&nbsp;</td><td>Add mac addresses to tabular format. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a65663f982cb1eec1717c9608584c2ff0"></a><!-- doxytag: member="yafcore.h::yfPrintString" ref="a65663f982cb1eec1717c9608584c2ff0" args="(GString *rstr, yfFlow_t *flow)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yfPrintString </td>
          <td>(</td>
          <td class="paramtype">GString *&nbsp;</td>
          <td class="paramname"> <em>rstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyf_flow__st.html">yfFlow_t</a> *&nbsp;</td>
          <td class="paramname"> <em>flow</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Print a YAF flow to a GString. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rstr</em>&nbsp;</td><td>string to append text representation of flow to. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flow</em>&nbsp;</td><td>flow to print. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a17ef8e5b972e0ec36d372a703604c85f"></a><!-- doxytag: member="yafcore.h::yfReaderForFP" ref="a17ef8e5b972e0ec36d372a703604c85f" args="(fBuf_t *fbuf, FILE *fp, GError **err)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fBuf_t* yfReaderForFP </td>
          <td>(</td>
          <td class="paramtype">fBuf_t *&nbsp;</td>
          <td class="paramname"> <em>fbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GError **&nbsp;</td>
          <td class="paramname"> <em>err</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get an IPFIX message buffer for reading YAF flows from an open file pointer. </p>
<p>Reuses an existing buffer if supplied.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fbuf</em>&nbsp;</td><td>IPFIX message buffer to reuse; must have been returned by a prior call to <a class="el" href="yafcore_8h.html#a17ef8e5b972e0ec36d372a703604c85f" title="Get an IPFIX message buffer for reading YAF flows from an open file pointer.">yfReaderForFP()</a>. Pass NULL to create a new buffer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fp</em>&nbsp;</td><td>File pointer to open file to read from. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>err</em>&nbsp;</td><td>an error description, set on failure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a new reader, or a reused reader, for reading the given open file. NULL on failure. </dd></dl>

</div>
</div>
<a class="anchor" id="a4916880e1835ed3bc8d2912791076caf"></a><!-- doxytag: member="yafcore.h::yfReadFlow" ref="a4916880e1835ed3bc8d2912791076caf" args="(fBuf_t *fbuf, yfFlow_t *flow, GError **err)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean yfReadFlow </td>
          <td>(</td>
          <td class="paramtype">fBuf_t *&nbsp;</td>
          <td class="paramname"> <em>fbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyf_flow__st.html">yfFlow_t</a> *&nbsp;</td>
          <td class="paramname"> <em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GError **&nbsp;</td>
          <td class="paramname"> <em>err</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read a single flow from an IPFIX message buffer. </p>
<p>The buffer must have been returned by <a class="el" href="yafcore_8h.html#a17ef8e5b972e0ec36d372a703604c85f" title="Get an IPFIX message buffer for reading YAF flows from an open file pointer.">yfReaderForFP()</a>, or by fbListenerWait() called on a listener created by <a class="el" href="yafcore_8h.html#a99e3f8d2e81765581ee143c1e5b77571" title="Get an IPFIX connection listener for collecting YAF flows via IPFIX from the network...">yfListenerForSpec()</a>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fbuf</em>&nbsp;</td><td>Buffer to read message from, returned by <a class="el" href="yafcore_8h.html#a17ef8e5b972e0ec36d372a703604c85f" title="Get an IPFIX message buffer for reading YAF flows from an open file pointer.">yfReaderForFP()</a> or from a YAF listener. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flow</em>&nbsp;</td><td>pointer to yfFlow_t structure to fill from file or stream. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>err</em>&nbsp;</td><td>an error description; required. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE on success, FALSE otherwise. If false, check error against FB_ERROR_EOF to determine if the message reader is at end of file or stream, or against FB_ERROR_EOM to see if the listener should be waited upon. </dd></dl>

</div>
</div>
<a class="anchor" id="a2508ff2b0d463c2689e382e4b46bc167"></a><!-- doxytag: member="yafcore.h::yfReadFlowExtended" ref="a2508ff2b0d463c2689e382e4b46bc167" args="(fBuf_t *fbuf, yfFlow_t *flow, GError **err)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean yfReadFlowExtended </td>
          <td>(</td>
          <td class="paramtype">fBuf_t *&nbsp;</td>
          <td class="paramname"> <em>fbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyf_flow__st.html">yfFlow_t</a> *&nbsp;</td>
          <td class="paramname"> <em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GError **&nbsp;</td>
          <td class="paramname"> <em>err</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read a single flow from an IPFIX message buffer. </p>
<p>The buffer must have been returned by <a class="el" href="yafcore_8h.html#a17ef8e5b972e0ec36d372a703604c85f" title="Get an IPFIX message buffer for reading YAF flows from an open file pointer.">yfReaderForFP()</a>, or by fbListenerWait() called on a listener created by <a class="el" href="yafcore_8h.html#a99e3f8d2e81765581ee143c1e5b77571" title="Get an IPFIX connection listener for collecting YAF flows via IPFIX from the network...">yfListenerForSpec()</a>. This function does not necessarily require its input to have been written by <a class="el" href="yafcore_8h.html#a4aba445d9e6561395ee1a2de5a91ac15" title="Write a single flow to an IPFIX message buffer.">yfWriteFlow()</a>; it supports additional flow timestamp and counter IEs that may be exported by other IPFIX exporting processes.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fbuf</em>&nbsp;</td><td>Buffer to read message from, returned by <a class="el" href="yafcore_8h.html#a17ef8e5b972e0ec36d372a703604c85f" title="Get an IPFIX message buffer for reading YAF flows from an open file pointer.">yfReaderForFP()</a> or from a YAF listener. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flow</em>&nbsp;</td><td>pointer to yfFlow_t structure to fill from file or stream. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>err</em>&nbsp;</td><td>an error description; required. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE on success, FALSE otherwise. If false, check error against FB_ERROR_EOF to determine if the message reader is at end of file or stream, or against FB_ERROR_EOM to see if the listener should be waited upon. </dd></dl>

</div>
</div>
<a class="anchor" id="a4aba445d9e6561395ee1a2de5a91ac15"></a><!-- doxytag: member="yafcore.h::yfWriteFlow" ref="a4aba445d9e6561395ee1a2de5a91ac15" args="(void *yfContext, yfFlow_t *flow, GError **err)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean yfWriteFlow </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>yfContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structyf_flow__st.html">yfFlow_t</a> *&nbsp;</td>
          <td class="paramname"> <em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GError **&nbsp;</td>
          <td class="paramname"> <em>err</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write a single flow to an IPFIX message buffer. </p>
<p>The buffer must have been returned by <a class="el" href="yafcore_8h.html#a753d03baaddfb6432f85f548c7afe683" title="Get an IPFIX message buffer for writing YAF flows to an open file pointer.">yfWriterForFP()</a> or <a class="el" href="yafcore_8h.html#a3c20540b8763c574b8a9c660f5b70972" title="Get an IPFIX message buffer for writing YAF flows to a socket.">yfWriterForSpec()</a>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>yfContext</em>&nbsp;</td><td>Context pointer for the yaf state, used to get the fbuf pointer, a buffer to write the message to, returned from <a class="el" href="yafcore_8h.html#a753d03baaddfb6432f85f548c7afe683" title="Get an IPFIX message buffer for writing YAF flows to an open file pointer.">yfWriterForFP()</a> or <a class="el" href="yafcore_8h.html#a3c20540b8763c574b8a9c660f5b70972" title="Get an IPFIX message buffer for writing YAF flows to a socket.">yfWriterForSpec()</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flow</em>&nbsp;</td><td>pointer to yfFlow_t to write to file or stream. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>err</em>&nbsp;</td><td>an error description; required. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE on success, FALSE otherwise. </dd></dl>

</div>
</div>
<a class="anchor" id="ace9d2497ad9dfacc3abb8cc20a95492b"></a><!-- doxytag: member="yafcore.h::yfWriterClose" ref="ace9d2497ad9dfacc3abb8cc20a95492b" args="(fBuf_t *fbuf, gboolean flush, GError **err)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean yfWriterClose </td>
          <td>(</td>
          <td class="paramtype">fBuf_t *&nbsp;</td>
          <td class="paramname"> <em>fbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&nbsp;</td>
          <td class="paramname"> <em>flush</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GError **&nbsp;</td>
          <td class="paramname"> <em>err</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Close the connection underlying an IPFIX message buffer created by <a class="el" href="yafcore_8h.html#a753d03baaddfb6432f85f548c7afe683" title="Get an IPFIX message buffer for writing YAF flows to an open file pointer.">yfWriterForFP()</a> or <a class="el" href="yafcore_8h.html#a3c20540b8763c574b8a9c660f5b70972" title="Get an IPFIX message buffer for writing YAF flows to a socket.">yfWriterForSpec()</a>. </p>
<p>If flush is TRUE, forces any message in progress to be emitted before close; use FALSE if closing the buffer in response to a write error. Does not free the buffer.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fbuf</em>&nbsp;</td><td>buffer to close. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flush</em>&nbsp;</td><td>TRUE to flush buffer before closing. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>err</em>&nbsp;</td><td>an error description, set on failure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE on success, FALSE otherwise. </dd></dl>

</div>
</div>
<a class="anchor" id="a1422ae5d15ad994a6e2e3fd40816c609"></a><!-- doxytag: member="yafcore.h::yfWriterForFile" ref="a1422ae5d15ad994a6e2e3fd40816c609" args="(const char *path, uint32_t domain, GError **err)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fBuf_t* yfWriterForFile </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GError **&nbsp;</td>
          <td class="paramname"> <em>err</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get an IPFIX message buffer for writing YAF flows to a named file. </p>
<p>Sets the observation domain of the buffer to the given value.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>path</em>&nbsp;</td><td>Name of the file to write to, or - for stdout. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>domain</em>&nbsp;</td><td>observation domain </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>err</em>&nbsp;</td><td>an error description, set on failure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>fBuf_t a new writer, or a reused writer, for writing on the given open file. NULL on failure. </dd></dl>

</div>
</div>
<a class="anchor" id="a753d03baaddfb6432f85f548c7afe683"></a><!-- doxytag: member="yafcore.h::yfWriterForFP" ref="a753d03baaddfb6432f85f548c7afe683" args="(FILE *fp, uint32_t domain, GError **err)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fBuf_t* yfWriterForFP </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GError **&nbsp;</td>
          <td class="paramname"> <em>err</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get an IPFIX message buffer for writing YAF flows to an open file pointer. </p>
<p>Sets the observation domain of the buffer to the given value. Note that this is intended for use with Airframe MIO based applications; non-MIO applications writing YAF IPFIX files should use yfWriterForFile instead.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fp</em>&nbsp;</td><td>File pointer to open file to write to. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>domain</em>&nbsp;</td><td>observation domain </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>err</em>&nbsp;</td><td>an error description, set on failure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>fBuf_t a new writer, or a reused writer, for writing on the given open file. NULL on failure. </dd></dl>

</div>
</div>
<a class="anchor" id="a3c20540b8763c574b8a9c660f5b70972"></a><!-- doxytag: member="yafcore.h::yfWriterForSpec" ref="a3c20540b8763c574b8a9c660f5b70972" args="(fbConnSpec_t *spec, uint32_t domain, GError **err)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fBuf_t* yfWriterForSpec </td>
          <td>(</td>
          <td class="paramtype">fbConnSpec_t *&nbsp;</td>
          <td class="paramname"> <em>spec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GError **&nbsp;</td>
          <td class="paramname"> <em>err</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get an IPFIX message buffer for writing YAF flows to a socket. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>spec</em>&nbsp;</td><td>fixbuf connection specifier for remote end of socket. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>domain</em>&nbsp;</td><td>observation domain </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>err</em>&nbsp;</td><td>an error description, set on failure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a new writer for export to the given address. </dd></dl>

</div>
</div>
<a class="anchor" id="aad688e7ab8e1c8a7c221db81b8b4ab9b"></a><!-- doxytag: member="yafcore.h::yfWriteStatsFlow" ref="aad688e7ab8e1c8a7c221db81b8b4ab9b" args="(void *yfContext, uint32_t pcap_drop, GTimer *timer, GError **err)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean yfWriteStatsFlow </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>yfContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>pcap_drop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GTimer *&nbsp;</td>
          <td class="paramname"> <em>timer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">GError **&nbsp;</td>
          <td class="paramname"> <em>err</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write an options data record to an IPFIX Message buffer. </p>
<p>To turn off stats output - use --nostats. Sets the internal template to the option template, builds the record, and sends it - then sets the internal template back to the full flow record.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>yfContext</em>&nbsp;</td><td>Context pointer for the yaf state, used to get the fbuf pointer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pcap_drop</em>&nbsp;</td><td>Number of packets dropped reported by libpcap </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timer</em>&nbsp;</td><td>Pointer to yafstats GTimer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>err</em>&nbsp;</td><td>an error description; required. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE on success, FALSE otherwise. </dd></dl>

</div>
</div>
</div>
      </div><!-- l-content -->
      <div id="l-footer">&copy; 2006-2013 Carnegie Mellon University</div>
    </div><!-- p-body -->
</body>
</html>   
